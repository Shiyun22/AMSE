import 'package:flutter/material.dart';

void main() {
  runApp(YumYonderApp());
}

/// üçΩ Nom de l'application : YumYonder
class YumYonderApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'YumYonder',
      theme: ThemeData(primarySwatch: Colors.orange),
      home: MainPage(),
      debugShowCheckedModeBanner: false,
    );
  }
}

/// üçΩ Mod√®le de donn√©es : Cat√©gorie culinaire
class Category {
  final String id;
  final String title;
  final String imageUrl;

  Category({required this.id, required this.title, required this.imageUrl});
}

/// üçΩ Mod√®le de donn√©es : Recette
class Dish {
  final String id;
  final String categoryId;
  final String title;
  final String imageUrl;
  final String description;
  final List<String> steps;
  ValueNotifier<bool> isLiked; // ‚úÖ Áî® ValueNotifier ÁõëÂê¨ÂèòÂåñ

  Dish({
  required this.id,
  required this.categoryId,
  required this.title,
  required this.imageUrl,
  required this.description,
  required this.steps,
  bool isLiked = false,
}) : isLiked = ValueNotifier<bool>(isLiked);
}




/// Donn√©es globales : 5 cat√©gories pr√©d√©finies
List<Category> categories = [
  Category(
    id: 'c1',
    title: 'Cuisine chinoise',
    imageUrl: 'https://i.postimg.cc/02BdMNnR/1.jpg',
  ),
  Category(
    id: 'c2',
    title: 'Cuisine fran√ßaise',
    imageUrl: 'https://i.postimg.cc/JnMbVHrJ/3.jpg',
  ),
  Category(
    id: 'c3',
    title: 'Cuisine japonaise',
    imageUrl: 'https://i.postimg.cc/RF04DB39/4.jpg',
  ),
  Category(
    id: 'c4',
    title: 'Cuisine cor√©enne',
    imageUrl: 'https://i.postimg.cc/D09h04xy/5.jpg',
  ),
  Category(
    id: 'c5',
    title: 'Cuisine tha√Ølandaise',
    imageUrl: 'https://i.postimg.cc/k5rQshLT/2.jpg',
  ),
];

/// Donn√©es globales : G√©n√©ration de 4 recettes par cat√©gorie, pour un total de 20 plats
List<Dish> allDishes = [
  // Cuisine chinoise
 Dish(
    id: 'd1',
    categoryId: 'c1',
    title: 'Canard laqu√©',
    imageUrl: 'https://i.postimg.cc/y6y8nsLJ/C1.jpg',
    description: 'Un plat traditionnel de P√©kin, peau croustillante et savoureuse.',
    steps: [
      'Nettoyer et s√©cher le canard.',
      'Badigeonner de miel et d‚Äô√©pices, puis laisser s√©cher 4 heures.',
      'Enfourner √† 200¬∞C jusqu‚Äô√† ce que la peau devienne croustillante.',
      'Trancher finement et servir avec des cr√™pes et sauce hoisin.',
    ],
  ),
  Dish(
    id: 'd2',
    categoryId: 'c1',
    title: 'C√¥tes de porc aigre-douce',
    imageUrl: 'https://i.postimg.cc/dVbFwxWP/C2.jpg',
    description: 'Un plat classique de la cuisine chinoise, compos√© de c√¥tes de porc croustillantes enrob√©es d\'une sauce aigre-douce savoureuse.',
    steps: [
    'Couper les c√¥tes de porc en morceaux et les faire mariner avec de la sauce soja, du vin de cuisine et de la f√©cule de ma√Øs pendant 30 minutes.',
    'Faire frire les morceaux de porc dans l\'huile chaude jusqu\'√† ce qu\'ils soient dor√©s et croustillants. Les √©goutter et les r√©server.',
    'Dans une po√™le, faire revenir de l\'ail et du gingembre hach√©s. Ajouter du vinaigre, du sucre, de la sauce soja et un peu d\'eau pour pr√©parer la sauce aigre-douce.',
    'Ajouter les morceaux de porc frits dans la sauce et bien m√©langer pour les enrober. Laisser mijoter quelques minutes jusqu\'√† ce que la sauce √©paississe.',
    'Servir chaud, garni de graines de s√©same et d\'oignons verts hach√©s.',
    ],
  ),
  Dish(
    id: 'd3',
    categoryId: 'c1',
    title: 'Soupe aigre-douce',
    imageUrl: 'https://i.postimg.cc/7PKMd866/C3.jpg',
    description: 'Une soupe r√©confortante avec une touche sucr√©e et piquante.',
    steps: [
      'Chauffer du bouillon de poulet.',
      'Ajouter du vinaigre, du sucre et de la sauce soja.',
      'Incorporer champignons, tofu et bambou.',
      'Ajouter un ≈ìuf battu en filet.',
    ],
  ),
  Dish(
    id: 'd4',
    categoryId: 'c1',
    title: 'Poulet Kung Pao',
    imageUrl: 'https://i.postimg.cc/KjWTzbkD/C4.jpg',
    description: 'Un plat √©pic√© saut√© avec cacahu√®tes et l√©gumes.',
    steps: [
      'Mariner le poulet avec sauce soja et f√©cule.',
      'Faire revenir ail, gingembre et piment dans un wok.',
      'Ajouter le poulet et faire sauter jusqu‚Äô√† cuisson.',
      'Incorporer l√©gumes et cacahu√®tes.',
    ],
  ),

  // Cuisine fran√ßaise
  Dish(
    id: 'd5',
    categoryId: 'c2',
    title: 'B≈ìuf bourguignon',
    imageUrl: 'https://i.postimg.cc/bJNS9r1R/F1.jpg',
    description: 'Un rago√ªt de b≈ìuf mijot√© dans du vin rouge avec des l√©gumes.',
    steps: [
      'Faire revenir les morceaux de b≈ìuf.',
      'Ajouter carottes, oignons et ail.',
      'D√©glacer avec du vin rouge.',
      'Laisser mijoter 2 heures √† feu doux.',
    ],
  ),
  Dish(
    id: 'd6',
    categoryId: 'c2',
    title: 'Coq au vin',
    imageUrl: 'https://i.postimg.cc/ZYQv6Tnr/F2.jpg',
    description: 'Un plat fran√ßais classique o√π le poulet est brais√© dans du vin.',
    steps: [
      'Faire revenir les morceaux de poulet.',
      'Ajouter des champignons, des oignons et du lard.',
      'D√©glacer avec du vin rouge et mijoter 2 heures.',
    ],
  ),

  Dish(
  id: 'd7',
  categoryId: 'c2',
  title: 'Ratatouille',
  imageUrl: 'https://i.postimg.cc/dVP7S483/F3.jpg',
  description: 'Un m√©lange savoureux de l√©gumes m√©diterran√©ens.',
  steps: [
    'Laver et couper les l√©gumes : aubergines, courgettes, poivrons et tomates.',
    'Faire revenir les oignons et l‚Äôail dans une po√™le avec de l‚Äôhuile d‚Äôolive.',
    'Ajouter les aubergines et laisser cuire 5 minutes.',
    'Incorporer les courgettes et les poivrons, puis laisser mijoter 10 minutes.',
    'Ajouter les tomates et les herbes de Provence.',
    'Laisser cuire √† feu doux pendant 30 minutes en remuant r√©guli√®rement.',
    'Rectifier l‚Äôassaisonnement avec sel et poivre.',
    'Servir chaud ou froid avec du pain ou du riz.',
  ],
),

  Dish(
  id: 'd8',
  categoryId: 'c2',
  title: 'Soupe √† l‚Äôoignon',
  imageUrl: 'https://i.postimg.cc/C1zkVddx/F4.jpg',
  description: 'Une soupe r√©confortante garnie de fromage fondu.',
  steps: [
    '√âplucher et √©mincer les oignons en fines lamelles.',
    'Faire revenir les oignons dans du beurre √† feu doux jusqu‚Äô√† caram√©lisation.',
    'Ajouter la farine et bien m√©langer pour √©paissir.',
    'Verser le bouillon de b≈ìuf et laisser mijoter pendant 30 minutes.',
    'Assaisonner avec sel, poivre et herbes aromatiques.',
    'Pr√©chauffer le four en mode grill.',
    'Verser la soupe dans des bols allant au four, ajouter une tranche de pain et recouvrir de fromage r√¢p√© (Gruy√®re ou Comt√©).',
    'Gratiner au four jusqu‚Äô√† ce que le fromage soit dor√© et fondu.',
    'Servir bien chaud avec du pain croustillant.',
  ],
),


  // Cuisine japonaise
  Dish(
  id: 'd9',
  categoryId: 'c3',
  title: 'Sushi',
  imageUrl: 'https://i.postimg.cc/RVcfmkCK/sushi.jpg',
  description: 'Des morceaux de poisson cru frais sur du riz vinaigr√©.',
  steps: [
    'Rincer le riz √† sushi plusieurs fois jusqu‚Äô√† ce que l‚Äôeau soit claire.',
    'Cuire le riz avec la bonne quantit√© d‚Äôeau selon les instructions.',
    'M√©langer le riz chaud avec du vinaigre de riz, du sucre et du sel.',
    'Laisser refroidir le riz √† temp√©rature ambiante.',
    'D√©couper le poisson (saumon, thon, etc.) en fines tranches.',
    'Former des petites boules de riz avec les mains l√©g√®rement humides.',
    'D√©poser d√©licatement une tranche de poisson sur chaque boule de riz.',
    'Servir avec du wasabi, du gingembre marin√© et de la sauce soja.',
  ],
),

 Dish(
  id: 'd10',
  categoryId: 'c3',
  title: 'Ramen',
  imageUrl: 'https://i.postimg.cc/tTKZQ5LB/ramen.jpg',
  description: 'Des nouilles servies dans un bouillon savoureux avec des garnitures.',
  steps: [
    'Pr√©parer un bouillon de base (porc, poulet ou miso) en mijotant pendant plusieurs heures.',
    'Cuire les nouilles ramen selon les instructions du paquet.',
    'Faire revenir du porc (chashu) ou du poulet pour la garniture.',
    'Ajouter du miso, de la sauce soja ou du sel au bouillon pour l‚Äôassaisonnement.',
    'Placer les nouilles cuites dans un bol et verser le bouillon chaud dessus.',
    'Ajouter les garnitures : ≈ìuf mollet marin√©, algues nori, ciboule et germes de soja.',
    'Saupoudrer √©ventuellement de graines de s√©same ou d‚Äôhuile de s√©same.',
    'Servir chaud avec des baguettes et une cuill√®re pour le bouillon.',
  ],
),

 Dish(
  id: 'd11',
  categoryId: 'c3',
  title: 'Tempura',
  imageUrl: 'https://i.postimg.cc/cLFv4Zpg/tempura.jpg',
  description: 'Des fruits de mer ou l√©gumes frits en beignet l√©ger.',
  steps: [
    'Pr√©parer les crevettes et l√©gumes (aubergines, carottes, patates douces, etc.) en les coupant en morceaux de taille uniforme.',
    'M√©langer la farine, l‚Äôeau glac√©e et l‚Äô≈ìuf dans un bol pour pr√©parer la p√¢te √† tempura.',
    'Tremper chaque ingr√©dient dans la p√¢te, en veillant √† ne pas trop en mettre.',
    'Faire chauffer l‚Äôhuile √† environ 180¬∞C.',
    'Faire frire les ingr√©dients en petites quantit√©s pour √©viter de refroidir l‚Äôhuile.',
    'Lorsque la p√¢te devient l√©g√®rement dor√©e et croustillante, retirer et √©goutter sur du papier absorbant.',
    'Servir chaud avec une sauce tentsuyu (m√©lange de dashi, sauce soja et mirin).',
  ],
),

 Dish(
  id: 'd12',
  categoryId: 'c3',
  title: 'Yakitori',
  imageUrl: 'https://i.postimg.cc/Hxyn2MVX/yakitori.jpg',
  description: 'Des brochettes de poulet grill√©es avec une sauce sucr√©e-sal√©e.',
  steps: [
    'Couper le poulet (cuisses ou blancs) en morceaux de taille √©gale.',
    'Pr√©parer la marinade avec de la sauce soja, du mirin, du sucre et du sak√©.',
    'Laisser mariner les morceaux de poulet pendant 30 minutes.',
    'Enfiler le poulet sur des brochettes en alternant avec des oignons verts.',
    'Faire chauffer un grill ou une po√™le et cuire les brochettes √† feu moyen.',
    'Badigeonner r√©guli√®rement de sauce pendant la cuisson.',
    'Cuire jusqu‚Äô√† ce que le poulet soit dor√© et l√©g√®rement caram√©lis√©.',
    'Servir chaud avec du riz ou comme amuse-bouche.',
  ],
),


  // Cuisine cor√©enne
 Dish(
  id: 'd13',
  categoryId: 'c4',
  title: 'Bibimbap',
  imageUrl: 'https://i.postimg.cc/P55q79Ct/Bibimbap.jpg',
  description: 'Un bol de riz m√©lang√© avec des l√©gumes et un ≈ìuf.',
  steps: [
    'Cuire du riz blanc et le garder au chaud.',
    'Faire sauter les l√©gumes s√©par√©ment (√©pinards, carottes, champignons, courgettes) avec un peu d‚Äôhuile de s√©same et d‚Äôail.',
    'Cuire du b≈ìuf marin√© avec de la sauce soja, de l‚Äôail et du sucre.',
    'Faire frire un ≈ìuf au plat.',
    'Dans un bol, disposer le riz chaud au fond.',
    'Ajouter les l√©gumes et le b≈ìuf autour du riz.',
    'D√©poser l‚Äô≈ìuf au centre et garnir de graines de s√©same et d‚Äôhuile de s√©same.',
    'Servir avec de la sauce gochujang (p√¢te de piment cor√©enne) √† m√©langer avant de d√©guster.',
  ],
),

 Dish(
  id: 'd14',
  categoryId: 'c4',
  title: 'Kimchi',
  imageUrl: 'https://i.postimg.cc/Dzty8zBZ/Kimchi.jpg',
  description: 'Un plat ferment√© √©pic√© √† base de chou et d‚Äôail.',
  steps: [
    'Couper un chou chinois en morceaux et le faire tremper dans de l‚Äôeau sal√©e pendant 2 heures.',
    'Rincer abondamment le chou et bien √©goutter.',
    'Pr√©parer la p√¢te √©pic√©e en m√©langeant du piment en poudre cor√©en (gochugaru), de l‚Äôail √©cras√©, du gingembre, de la sauce poisson et du sucre.',
    'Ajouter des carottes et des oignons verts finement tranch√©s.',
    'M√©langer le chou avec la p√¢te √©pic√©e en veillant √† bien enrober chaque feuille.',
    'Mettre le kimchi dans un bocal herm√©tique et laisser fermenter √† temp√©rature ambiante pendant 1 √† 2 jours.',
    'Placer ensuite au r√©frig√©rateur et laisser fermenter encore quelques jours avant de d√©guster.',
    'Servir comme accompagnement ou dans des plats cor√©ens comme le bibimbap.',
  ],
),

 Dish(
  id: 'd15',
  categoryId: 'c4',
  title: 'Tteokbokki',
  imageUrl: 'https://i.postimg.cc/qMjJ2wjW/Tteokbokki.jpg',
  description: 'Des g√¢teaux de riz √©pic√©s dans une sauce sucr√©e et piquante.',
  steps: [
    'Faire tremper les g√¢teaux de riz (tteok) dans l‚Äôeau ti√®de pendant 30 minutes si n√©cessaire.',
    'Dans une casserole, m√©langer de l‚Äôeau, du gochujang (p√¢te de piment cor√©enne), du sucre et de la sauce soja.',
    'Porter √† √©bullition, puis ajouter les g√¢teaux de riz et remuer.',
    'Laisser mijoter √† feu moyen jusqu‚Äô√† ce que la sauce √©paississe et enrobe bien les g√¢teaux de riz.',
    'Ajouter des oignons verts, des ≈ìufs durs et des boulettes de poisson.',
    'Servir chaud avec des graines de s√©same et un peu d‚Äôhuile de s√©same.',
  ],
),

Dish(
  id: 'd16',
  categoryId: 'c4',
  title: 'Bulgogi',
  imageUrl: 'https://i.postimg.cc/441sTwkn/Bulgogi.jpg',
  description: 'De fines tranches de b≈ìuf marin√©es et grill√©es.',
  steps: [
    'Trancher finement du b≈ìuf (contre-filet ou bavette).',
    'Pr√©parer la marinade avec de la sauce soja, du sucre, de l‚Äôail, du gingembre, du mirin et de l‚Äôhuile de s√©same.',
    'Laisser mariner la viande pendant au moins 1 heure.',
    'Faire chauffer une po√™le ou un grill √† feu vif.',
    'Faire cuire les morceaux de b≈ìuf marin√©s jusqu‚Äô√† ce qu‚Äôils soient bien dor√©s.',
    'Ajouter des oignons verts et des graines de s√©same pour plus de saveur.',
    'Servir avec du riz blanc et des l√©gumes ferment√©s (kimchi).',
  ],
),


  // Cuisine tha√Ølandaise
Dish(
  id: 'd17',
  categoryId: 'c5',
  title: 'Pad Tha√Ø',
  imageUrl: 'https://i.postimg.cc/s2SCH44j/Pad-Tha.jpg',
  description: 'Des nouilles saut√©es avec des crevettes, ≈ìufs et cacahu√®tes.',
  steps: [
    'Faire tremper les nouilles de riz dans de l‚Äôeau ti√®de jusqu‚Äô√† ce qu‚Äôelles ramollissent.',
    'Dans un wok, faire revenir l‚Äôail et les crevettes avec un peu d‚Äôhuile.',
    'Ajouter les nouilles √©goutt√©es et assaisonner avec de la sauce tamarin, du sucre et de la sauce poisson.',
    'Pousser les nouilles sur le c√¥t√© et casser un ≈ìuf dans le wok.',
    'M√©langer l‚Äô≈ìuf avec les nouilles jusqu‚Äô√† ce qu‚Äôil soit cuit.',
    'Ajouter des pousses de soja, des oignons verts et des cacahu√®tes concass√©es.',
    'Servir chaud avec un quartier de citron vert et du piment en poudre.',
  ],
),

Dish(
  id: 'd18',
  categoryId: 'c5',
  title: 'Tom Yum',
  imageUrl: 'https://i.postimg.cc/sgdc9Px9/Tom-Yum.jpg',
  description: 'Une soupe √©pic√©e aux crevettes et citronnelle.',
  steps: [
    'Faire chauffer de l‚Äôeau ou du bouillon dans une casserole.',
    'Ajouter des tiges de citronnelle, des feuilles de combava et du galanga.',
    'Incorporer les crevettes et les champignons tranch√©s.',
    'Ajouter du piment, de la sauce poisson et du jus de citron vert.',
    'Laisser mijoter jusqu‚Äô√† ce que les crevettes soient cuites.',
    'Servir chaud avec de la coriandre fra√Æche et des rondelles de piment rouge.',
  ],
),

Dish(
  id: 'd19',
  categoryId: 'c5',
  title: 'Som Tam',
  imageUrl: 'https://i.postimg.cc/T1bkfth1/Som-Tam.jpg',
  description: 'Une salade de papaye verte √©pic√©e et rafra√Æchissante.',
  steps: [
    '√âplucher et r√¢per une papaye verte.',
    'Dans un mortier, piler de l‚Äôail et du piment rouge.',
    'Ajouter du sucre de palme, de la sauce poisson et du jus de citron vert.',
    'Incorporer des tomates cerises et des haricots longs coup√©s en morceaux.',
    'Ajouter la papaye r√¢p√©e et bien m√©langer.',
    'Servir frais avec des cacahu√®tes concass√©es et quelques crevettes s√©ch√©es.',
  ],
),

Dish(
  id: 'd20',
  categoryId: 'c5',
  title: 'Curry vert',
  imageUrl: 'https://i.postimg.cc/9M6p8y1h/Curry-vert.jpg',
  description: 'Un curry au lait de coco avec du poulet et des l√©gumes.',
  steps: [
    'Faire chauffer de l‚Äôhuile dans une po√™le et ajouter la p√¢te de curry vert.',
    'Faire revenir la p√¢te jusqu‚Äô√† ce qu‚Äôelle d√©gage son ar√¥me.',
    'Ajouter du lait de coco et laisser mijoter quelques minutes.',
    'Incorporer des morceaux de poulet et cuire jusqu‚Äô√† ce qu‚Äôils soient tendres.',
    'Ajouter des l√©gumes (aubergines tha√Øes, haricots longs, poivrons) et laisser cuire.',
    'Assaisonner avec du sucre, de la sauce poisson et du basilic tha√Ø.',
    'Servir chaud avec du riz jasmin.',
  ],
),

];


/// üçΩ Page principale avec navigation
class MainPage extends StatefulWidget {
  @override
  _MainPageState createState() => _MainPageState();
}

class _MainPageState extends State<MainPage> {
  int _selectedIndex = 0;
  final List<Widget> _pages = [HomePage(), LikedPage(), AboutPage()];

  void _onItemTapped(int index) {
    setState(() {
      _selectedIndex = index;
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: _pages[_selectedIndex],
      bottomNavigationBar: BottomNavigationBar(
        currentIndex: _selectedIndex,
        onTap: _onItemTapped,
        selectedItemColor: Colors.orange,
        unselectedItemColor: Colors.grey,
        items: const [
          BottomNavigationBarItem(icon: Icon(Icons.home), label: 'Accueil'),
          BottomNavigationBarItem(icon: Icon(Icons.favorite), label: 'Lik√©'),
          BottomNavigationBarItem(icon: Icon(Icons.info), label: '√Ä propos'),
        ],
      ),
    );
  }
}

/// üçΩ Page d'accueil : Affichage des cat√©gories
class HomePage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('YumYonder')),
      body: GridView.builder(
        padding: const EdgeInsets.all(10),
        itemCount: categories.length,
        gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(
          crossAxisCount: 2,
          childAspectRatio: 3 / 2,
          crossAxisSpacing: 10,
          mainAxisSpacing: 10,
        ),
        itemBuilder: (ctx, index) {
          final category = categories[index];
          return GestureDetector(
            onTap: () {
              Navigator.push(context, MaterialPageRoute(
                builder: (context) => DishListPage(category: category),
              ));
            },
            child: GridTile(
              child: Image.network(category.imageUrl, fit: BoxFit.cover),
              footer: GridTileBar(backgroundColor: Colors.black54, title: Text(category.title, textAlign: TextAlign.center)),
            ),
          );
        },
      ),
    );
  }
}

class DishListPage extends StatelessWidget {
  final Category category;
  DishListPage({required this.category});

  @override
  Widget build(BuildContext context) {
    final List<Dish> categoryDishes = allDishes.where((dish) => dish.categoryId == category.id).toList();
    return Scaffold(
      appBar: AppBar(title: Text('${category.title}')),
      body: ListView.builder(
        itemCount: categoryDishes.length,
        itemBuilder: (ctx, index) {
          final dish = categoryDishes[index];
          return ListTile(
            leading: Container(
              width: 80, // Ë∞ÉÊï¥ÂÆΩÂ∫¶
              height: 150, // Ë∞ÉÊï¥È´òÂ∫¶
              decoration: BoxDecoration(
                borderRadius: BorderRadius.circular(10), // ÂèØÈÄâÔºöÊ∑ªÂä†ÂúÜËßí
              ),
              child: ClipRRect(
                borderRadius: BorderRadius.circular(10), // ÂèØÈÄâÔºöÊ∑ªÂä†ÂúÜËßí
                child: Image.network(
                  dish.imageUrl,
                  fit: BoxFit.cover, // ‰øùÊåÅÂõæÁâáÊØî‰æã
                ),
              ),
            ),
            title: Text(
              dish.title,
              style: TextStyle(fontSize: 26), // Ë∞ÉÊï¥Â≠ó‰ΩìÂ§ßÂ∞è
            ),
            trailing: ValueListenableBuilder<bool>(
              valueListenable: dish.isLiked,
              builder: (context, isLiked, child) {
                return IconButton(
                  icon: Icon(isLiked ? Icons.favorite : Icons.favorite_border, color: isLiked ? Colors.red : null),
                  onPressed: () => dish.isLiked.value = !dish.isLiked.value,
                );
              },
            ),
            onTap: () => Navigator.push(context, MaterialPageRoute(builder: (context) => DishDetailPage(dish: dish))),
          );
        },
      ),
    );
  }
}

/// üçΩ Page des recettes lik√©es
class LikedPage extends StatefulWidget {
  @override
  _LikedPageState createState() => _LikedPageState();
}

class _LikedPageState extends State<LikedPage> {
  final List<ValueNotifier<bool>> _listeners = [];

  @override
  void initState() {
    super.initState();
    // ‰∏∫ÊØè‰∏™ËèúÂìÅÁöÑ isLiked Ê∑ªÂä†ÁõëÂê¨Âô®
    for (final dish in allDishes) {
      dish.isLiked.addListener(_onLikeChanged);
      _listeners.add(dish.isLiked);
    }
  }

  @override
  void dispose() {
    // ÁßªÈô§ÊâÄÊúâÁõëÂê¨Âô®ÈÅøÂÖçÂÜÖÂ≠òÊ≥ÑÊºè
    for (final listener in _listeners) {
      listener.removeListener(_onLikeChanged);
    }
    super.dispose();
  }

  void _onLikeChanged() {
    // ÂΩì‰ªª‰ΩïÊî∂ËóèÁä∂ÊÄÅÂèòÂåñÊó∂Âà∑Êñ∞È°µÈù¢
    setState(() {});
  }

  @override
  Widget build(BuildContext context) {
    final likedDishes = allDishes.where((dish) => dish.isLiked.value).toList();
    return Scaffold(
      appBar: AppBar(
        title: Text('Lik√©'),
        backgroundColor: Colors.pink[300], // AppBar ËÉåÊôØËâ≤
      ),
      body: Container(
        color: Colors.pink[50], // Á≤âËâ≤ËÉåÊôØ
        child: likedDishes.isEmpty
            ? Center(
                child: Text(
                  'Aucune recette lik√©e pour le moment.',
                  style: TextStyle(
                    fontSize: 18,
                    color: Colors.pink[800], // ÊñáÂ≠óÈ¢úËâ≤
                    fontWeight: FontWeight.w500, // ÊñáÂ≠óÂä†Á≤ó
                  ),
                ),
              )
            : ListView.builder(
                itemCount: likedDishes.length,
                itemBuilder: (ctx, index) {
                  final dish = likedDishes[index];
                  return Card(
                    margin: EdgeInsets.symmetric(horizontal: 16, vertical: 8),
                    elevation: 4, // Âç°ÁâáÈò¥ÂΩ±
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(10), // Âç°ÁâáÂúÜËßí
                    ),
                    child: ListTile(
                      leading: Container(
                        width: 80, // ÂõæÁâáÂÆΩÂ∫¶
                        height: 120, // ÂõæÁâáÈ´òÂ∫¶
                        decoration: BoxDecoration(
                          borderRadius: BorderRadius.circular(10), // ÂúÜËßí
                        ),
                        child: ClipRRect(
                          borderRadius: BorderRadius.circular(10), // ÂúÜËßí
                          child: Image.network(
                            dish.imageUrl,
                            fit: BoxFit.cover, // ‰øùÊåÅÂõæÁâáÊØî‰æã
                          ),
                        ),
                      ),
                      title: Text(
                        dish.title,
                        style: TextStyle(
                          fontSize: 18,
                          fontWeight: FontWeight.bold,
                          color: Colors.pink[800], // ÊñáÂ≠óÈ¢úËâ≤
                        ),
                      ),
                      trailing: ValueListenableBuilder<bool>(
                        valueListenable: dish.isLiked,
                        builder: (context, isLiked, child) {
                          return IconButton(
                            icon: Icon(
                              isLiked ? Icons.favorite : Icons.favorite_border,
                              color: isLiked ? Colors.pink[300] : Colors.grey,
                            ),
                            onPressed: () => dish.isLiked.value = !isLiked,
                          );
                        },
                      ),
                      onTap: () => Navigator.push(
                        context,
                        MaterialPageRoute(
                          builder: (context) => DishDetailPage(dish: dish),
                        ),
                      ),
                    ),
                  );
                },
              ),
      ),
    );
  }
}

class DishDetailPage extends StatelessWidget {
  final Dish dish;
  DishDetailPage({required this.dish});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text(dish.title)),
      body: SingleChildScrollView(
        padding: const EdgeInsets.all(16),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.stretch,
          children: [
            // ËèúÂìÅÂõæÁâá
            Center(
              child: Container(
                width: 300, // Áº©Â∞èÂõæÁâáÂÆΩÂ∫¶
                height: 300, // Áº©Â∞èÂõæÁâáÈ´òÂ∫¶
                child: ClipRRect(
                  borderRadius: BorderRadius.circular(10), // ÂèØÈÄâÔºöÊ∑ªÂä†ÂúÜËßí
                  child: Image.network(
                    dish.imageUrl,
                    fit: BoxFit.cover, // ‰øùÊåÅÂõæÁâáÊØî‰æã
                  ),
                ),
              ),
            ),
            const SizedBox(height: 16),
            // ËèúÂìÅÂêçÁß∞
            Text(
              dish.title,
              style: const TextStyle(fontSize: 24, fontWeight: FontWeight.bold),
            ),
            const SizedBox(height: 8),
            // ËèúÂìÅÊèèËø∞
            Text(
              dish.description,
              style: const TextStyle(fontSize: 16),
            ),
            const SizedBox(height: 16),
            // Êî∂ËóèÊåâÈíÆ
            Center(
              child: ValueListenableBuilder<bool>(
                valueListenable: dish.isLiked,
                builder: (context, isLiked, child) {
                  return IconButton(
                    icon: Icon(
                      isLiked ? Icons.favorite : Icons.favorite_border,
                      color: isLiked ? Colors.red : null,
                      size: 30,
                    ),
                    onPressed: () => dish.isLiked.value = !dish.isLiked.value,
                  );
                },
              ),
            ),
            const SizedBox(height: 16),
            // ÂÅöÈ•≠Ê≠•È™§Ê†áÈ¢ò
            Text(
              '√âtapes de pr√©paration:',
              style: const TextStyle(fontSize: 20, fontWeight: FontWeight.bold),
            ),
            const SizedBox(height: 8),
            // ÂÅöÈ•≠Ê≠•È™§ÂàóË°®
            ...dish.steps.map((step) {
              return Padding(
                padding: const EdgeInsets.symmetric(vertical: 4),
                child: Text(
                  '‚Ä¢ $step',
                  style: const TextStyle(fontSize: 16),
                ),
              );
            }).toList(),
          ],
        ),
      ),
    );
  }
}

/// üçΩ Page √Ä propos
class AboutPage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: const Text('√Ä propos de YumYonder'),
        backgroundColor: Colors.orange, // ‰øùÊåÅ‰∏é‰∏ªÈ¢ò‰∏ÄËá¥
      ),
      body: Container(
        color: Colors.yellow[50], // Ê∑°ÈªÑËâ≤ËÉåÊôØ
        child: Center(
          child: Padding(
            padding: const EdgeInsets.all(16.0),
            child: Column(
              mainAxisAlignment: MainAxisAlignment.center,
              children: [
                Icon(
                  Icons.restaurant_menu,
                  size: 60,
                  color: Colors.orange, // ÂõæÊ†áÈ¢úËâ≤
                ),
                const SizedBox(height: 20),
                const Text(
                  'üì≤ YumYonder ‚Äì La passion de la cuisine, √† port√©e de main ! üç¥‚ú®\n\n'
                  'Vous adorez cuisiner ? Vous cherchez des recettes exquises pour ravir vos papilles ? \n'
                  'YumYonder est l‚Äôapplication qu‚Äôil vous faut ! üéâ\n',
                  textAlign: TextAlign.center,
                  style: TextStyle(
                    fontSize: 18,
                    color: Colors.black87, // ÊñáÂ≠óÈ¢úËâ≤
                    fontWeight: FontWeight.w500, // ÊñáÂ≠óÂä†Á≤ó
                  ),
                ),
                const SizedBox(height: 20),
                const Text(
                  'D√©velopp√© avec ‚ù§Ô∏è par votre √©quipe YumYonder',
                  style: TextStyle(
                    fontSize: 14,
                    color: Colors.grey, // ÁÅ∞Ëâ≤ÊñáÂ≠ó
                    fontStyle: FontStyle.italic, // Êñú‰Ωì
                  ),
                ),
              ],
            ),
          ),
        ),
      ),
    );
  }
}